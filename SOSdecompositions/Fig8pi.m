%theta=pi/4
x=0:0.01:1;
y=0:0.01:0.5;
z=0:0.01:1;
[x,y,z] = meshgrid(x,y,z);
f = {@(x,y,z)-x ...
    @(x,y,z)-z ...
    @(x,y,z)-(x.*y-2*y-z-x+x.*z+y.*z+1) ...
    @(x,y,z) -(1-y-z)};

%%
%theta=pi/8 论文中的矩阵
x=0:0.01:2;
y=-0.4:0.01:0.4;
z=0:0.01:3;
[x,y,z] = meshgrid(x,y,z);
f = {@(x,y,z)-(y/2 - x + 5/3)...
@(x,y,z)-(3*y - z + 2)...   
@(x,y,z)-(2/3 - y)...
@(x,y,z)-((5*x)/3 + (x.*y)/2 - x.^2 - 1/2)...
@(x,y,z)-(2*x + 3*x.*y - x.*z - (9*y.^2)/2)...
@(x,y,z)-((22*y)/3 - 2*x - (5*z)/3 - 3*x.*y + x.*z - (y.*z)/2 - (5*y.^2)/2 + 29/9)...
@(x,y,z)-((2*z)/3 - (4*y)/3 - y.*z - 2*y.^2 - 2/9)...
@(x,y,z)-((29*x)/9 - (5*y)/2 + z/2 + (22*x.*y)/3 - (5*x.*z)/3 + 2*x.*y.^2 - 3*y.*x.^2 + z.*x.^2 - 2*x.^2 - (3*y.^2)/2 - (9*y.^3)/4 - (x.*y.*z)/2 - 1)};

%利用自己计算得到的矩阵画图
% k1=-1:0.1:1;
% k2=-3:0.1:0;
% k4=-3/2:0.1:0;
% [k1,k2,k4] = meshgrid(k1,k2,k4);
% f = {@(k1,~,k4)-(k1 + 2*k4 + 2)...
%     @(~,~,k4)-(-2*k4)...
%     @(k1,k2,~)-(6*k1+2*k2)...
%     @(~,k2,~)-(-2*k2)...
%     @(k1,~,~)-(2-2*k1)...
%     @(k1,~,k4)-(-4*k4-2*k1.*k4-4*k4.^2-9/8)...
%     @(k1,k2,k4)-(12*k1+4*k2+2*k1.*k2+12*k1.*k4+4*k2.*k4-12*k1.^2+3*2^(1/2)*3^(1/2)*6^(1/2)*k1-9/2)...
%     @(k1,k2,k4)-(20*k1-12*k1.*k4-4*k2.*k4-16*k1.^2 - 25/4)...
%     @(k1,k2,~)-(4*k1.*k2-4*k2-8*k1.^2+(2*2^(1/2)*3^(1/2)*6^(1/2)*k1)/3-1/2)...
%     @(k1,k2,k4)-(9*k1-(9*k2)/4-(7*k4)/2+16*k1.*k4 - 8*k2.*k4-24*k1.*k4.^2-8*k4.*k1.^2-8*k2.*k4.^2-12*k1.^2 ...
%     - 16*k1.^3-4*k1.*k2.*k4+6*2^(1/2)*3^(1/2)*6^(1/2)*k1.^2-(15*2^(1/2)*3^(1/2)*6^(1/2)*k1)/4-6*2^(1/2)*3^(1/2)*6^(1/2)*k1.*k4-5/4)};
c = f{1}(x,y,z);
for i =2:numel(f)% 2:3 %2:numel(f)
    c = max(c, f{i}(x,y,z));
end
p = patch(isosurface(x,y,z,c,0));
isonormals(x,y,z,c,p)
set(p,'facecolor',[0 .5 1],'edgecolor','none')
view(150,30),axis image,grid on
camlight
lighting gouraud

%%

k1=-4/5:0.1:4/5;
k2=-4/3:0.1:0;
k4=-5:0.1:0;
[k1,k2,k4] = meshgrid(k1,k2,k4);
f = {@(k1,~,k4)-((3*k1)/2 + 6*k4+ 12/5)...%@(k1,k2,~)-(10*k1+6*k2)...
    @(~,~,k4)-(-6*k4)...
    @(~,k2,~)-(-6*k2)...
    @(k1,~,~)-(24/5-6*k1)...
    @(k1,~,k4)-(-(144*k4)/5-9*k1.*k4-36*k4.^2-9/8)...
    @(k1,k2,k4)-(78*k1+(144*k2)/5 + 9*k1.*k2 + 60*k1.*k4 + 36*k2.*k4 - 10*k1.^2 - 9)...
    @(k1,k2,k4)-((216*k1)/5-60*k1.*k4-36*k2.*k4-32*k1.^2-729/50)...
    @(k1,k2,~)-((24*k1)/5 - (144*k2)/5 + 36*k1.*k2 - 8*k1.^2- 18/25)...
    @(k1,k2,k4)-((4887*k1)/50-(27*k2)/4-(837*k4)/25-(1044*k1.*k4)/5-(864*k2.*k4)/5-360*k1.*k4.^2 ...
               -132*k4.*k1.^2-216*k2.*k4.^2-(144*k1.^2)/5-48*k1.^3- 54*k1.*k2.*k4-11421/250)};

c = f{1}(k1,k2,k4);
for i =2:8%numel(f)%2:numel(f)
    c = max(c,f{i}(k1,k2,k4));
end
p = patch(isosurface(k1,k2,k4,c,0));
isonormals(k1,k2,k4,c,p)
set(p,'facecolor',[0 .5 1],'edgecolor','none')
view(150,30),axis image,grid on
camlight
lighting gouraud


%%
x=0:0.1:2;
y=0:0.1:2;
z=-12/5:0.1:12/5;
[x,y,z] = meshgrid(x,y,z);
f = {@(x,y,z)-(x)...
@(x,y,z)-(z/4 - x + 12/5)...   
@(x,y,z)-((5*z)/3 - y)...
@(x,y,z)-(y)...
@(x,y,z)-(12/5 - z)...
@(x,y,z)-((12*x)/5 + (x.*z)/4 - x.^2 - 9/32)...
@(x,y,z)-((5*z)/2 - x.*y + (5*x.*z)/3 - (25*z.^2)/36 - 9/4)...
@(x,y,z)-((38*z)/5 - (12*y)/5 + x.*y - (5*x.*z)/3 - (y.*z)/4 - (17*z.^2)/36 - 729/200 ) ...
@(x,y,z)-((12*y)/5 + (2*z)/5 - y.*z - (2*z.^2)/9 - 9/50) ...
@(x,y,z)-((9*y)/32 - (279*x)/200 + (57*z)/32 - (12*x.*y)/5 + (51*x.*z)/10 + y.*x.^2 + (2*x.*z.^2)/9 - (5*z.*x.^2)/3 - (5*z.^2)/24 - (25*z.^3)/144 - (x.*y.*z)/4 - 189/80)};


c = f{1}(x,y,z);
for i =2:numel(f)% 2:3 %2:numel(f)
    c = max(c, f{i}(x,y,z));
end
p = patch(isosurface(x,y,z,c,0));
isonormals(x,y,z,c,p)
set(p,'facecolor',[0 .5 1],'edgecolor','none')
view(150,30),axis image,grid on
camlight
lighting gouraud

%%
x=0:0.1:2;
y=0:0.1:2;
z=-40/9:0.1:40/9;
[x,y,z] = meshgrid(x,y,z);
f = {@(x,y,z)-(x)...
    @(x,y,z)-(z/8 - x + 40/9)...
    @(x,y,z)-((9*z)/7 - y)...
    @(x,y,z)-(y)...
    @(x,y,z)-(40/9 - z)...
    @(x,y,z)-((40*x)/9 + (x.*z)/8 - x.^2 - 25/128)...
    @(x,y,z)-((530*z)/63 - (40*y)/9 + x.*y - (9*x.*z)/7 - (y.*z)/8 - (65*z.^2)/392 - 7225/1296)...
    @(x,y,z)-((45*z)/28 - x.*y + (9*x.*z)/7 - (81*z.^2)/392 - 25/8)...
    @(x,y,z)-((40*y)/9 + (10*z)/63 - y.*z - (2*z.^2)/49 - 25/162)...
    @(x,y,z)-((25*y)/128 - (3175*x)/1296 + (4175*z)/896 - (40*x.*y)/9 + (245*x.*z)/36 + y.*x.^2 + (2*x.*z.^2)/49 - (9*z.*x.^2)/7 - (765*z.^2)/1568 - (81*z.^3)/3136 - (x.*y.*z)/8 - 5875/576)};
c = f{1}(x,y,z);
for i =2:numel(f)% 2:3 %2:numel(f)
    c = max(c, f{i}(x,y,z));
end
p = patch(isosurface(x,y,z,c,0));
isonormals(x,y,z,c,p)
set(p,'facecolor',[0 .5 1],'edgecolor','none')
view(150,30),axis image,grid on
camlight
lighting gouraud



%%
syms u alpha
2*(1+sin(2*u)^2)*cos(u)-4*cos(u)+2*cos(2*u)*(cos(u)-sin(2*u)*sin(u));
2*(1+sin(2*u)^2)*cos(u)-4*sin(2*u)*sin(u)+2*cos(2*u)*(-sin(2*u)*sin(u)-cos(u));

x=1/(alpha^2+sin(2*u)^2)*((4*lapha*cos(2*u)*sin(u)^2)/(alpha-2*sin(u)^2)+cos(2*u)*(alpha+2*sin(u)^2));




